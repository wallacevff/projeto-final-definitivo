<section class="courses">
  <header class="courses__header">
    <div>
      <h2>Cursos publicados</h2>
      <p class="description">Visualize a disponibilidade das trilhas e acompanhe o envolvimento dos alunos.</p>
    </div>
    <button type="button">Novo curso</button>
  </header>

  <ng-container *ngIf="!loading(); else loadingState">
    <ng-container *ngIf="!error(); else errorState">
      <div class="courses__grid">
        <article
          *ngFor="let course of courses(); trackBy: trackByCourseId"
          class="course-card"
          [attr.data-status]="course.published ? 'Publicado' : 'Rascunho'"
        >
          <div class="course-card__header">
            <span class="course-card__category">{{ course.category }}</span>
            <span class="course-card__status">{{ course.published ? 'Publicado' : 'Rascunho' }}</span>
          </div>

          <h3>{{ course.title }}</h3>

          <div class="course-card__meta">
            <span>Instrutor: <strong>{{ course.instructor }}</strong></span>
            <span>Modalidade: {{ course.modeLabel }}</span>
            <span *ngIf="course.published && course.publishedAt">Publicado em {{ course.publishedAt | date:'dd/MM/yyyy' }}</span>
          </div>

          <div class="course-card__footer">
            <div class="progress">
              <label>Ocupacao das turmas</label>
              <div class="progress__bar">
                <span [style.width.%]="percentOccupied(course)"></span>
              </div>
              <small>{{ course.enrolledStudents }} inscritos · {{ course.classGroups }} turmas · {{ percentOccupied(course) }}%</small>
            </div>
            <div class="stats">
              <button type="button">Gerenciar</button>
            </div>
          </div>
        </article>
      </div>
    </ng-container>
  </ng-container>
</section>

<ng-template #loadingState>
  <div class="state state--info">Carregando cursos...</div>
</ng-template>

<ng-template #errorState>
  <div class="state state--error">{{ error() }}</div>
</ng-template>

