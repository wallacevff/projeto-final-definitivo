import{a as A}from"./chunk-HMX4YSKT.js";import{b as z}from"./chunk-E66WUFVC.js";import{a as D,b as w,c as L,d as R}from"./chunk-LIHITQLG.js";import{b as k}from"./chunk-PD3M4KJI.js";import{g as O,h as S,k as E}from"./chunk-TDWUSEOQ.js";import{Ab as C,Gb as u,I,Ia as s,N as y,T as l,Ta as M,Xa as c,ea as F,fb as m,hb as T,jb as i,kb as o,m as v,ma as g,mb as h,nb as x,q as P,tb as d,x as b,xb as f,yb as a,zb as p}from"./chunk-IFOETVGF.js";function j(e,n){let{items:t}=L(e);return t.map(r=>({id:r.Id,title:r.Title,courseTitle:n.get(r.CourseId)??"Curso desconhecido",replies:N(r.Posts??[]),lastActivityLabel:z(r.LastActivityAt),authorId:r.CreatedById,isPinned:r.IsPinned,isLocked:r.IsLocked}))}function N(e){let n=e.length;return e.forEach(t=>{n+=N(t.Replies??[])}),n}var _=class e{http=l(k);baseUrl=w.baseUrl;getThreads(n){let t=R({PageSize:20,PageNumber:1});return this.http.get(`${this.baseUrl}/forum/threads`,{params:t}).pipe(b(()=>v({dados:[]})),P(r=>j(r,n)))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})};function q(e,n){e&1&&(i(0,"span",17),a(1,"Destacado"),o())}function $(e,n){e&1&&(i(0,"span",18),a(1,"Bloqueado"),o())}function G(e,n){if(e&1&&(i(0,"article",10)(1,"div",11)(2,"span",12),c(3,q,2,0,"span",13),i(4,"span",14),a(5),o(),c(6,$,2,0,"span",15),o(),i(7,"span",16),a(8),o()(),i(9,"h3"),a(10),o(),i(11,"footer")(12,"span"),a(13),o(),i(14,"span"),a(15),o(),i(16,"button",5),a(17,"Abrir discussao"),o()()()),e&2){let t=n.$implicit;T("thread--locked",t.isLocked),s(3),m("ngIf",t.isPinned),s(2),p(t.courseTitle),s(),m("ngIf",t.isLocked),s(2),C("Criado por ",t.authorId,""),s(2),p(t.title),s(3),C("",t.replies," respostas"),s(2),p(t.lastActivityLabel)}}function J(e,n){if(e&1&&(i(0,"div",8),c(1,G,18,9,"article",9),o()),e&2){let t=d(3);s(),m("ngForOf",t.threads())("ngForTrackBy",t.trackByThread)}}function K(e,n){if(e&1&&(h(0),c(1,J,2,2,"div",7),x()),e&2){let t=d(2),r=f(15);s(),m("ngIf",t.threads().length)("ngIfElse",r)}}function Q(e,n){if(e&1&&(h(0),c(1,K,2,2,"ng-container",6),x()),e&2){let t=d(),r=f(13);s(),m("ngIf",!t.error())("ngIfElse",r)}}function V(e,n){e&1&&(i(0,"div",19),a(1,"Carregando forum..."),o())}function W(e,n){if(e&1&&(i(0,"div",20),a(1),o()),e&2){let t=d();s(),p(t.error())}}function X(e,n){e&1&&(i(0,"div",19),a(1,"Nenhum topico cadastrado por enquanto."),o())}var B=class e{forumService=l(_);coursesService=l(A);destroyRef=l(F);loading=g(!0);error=g(null);threads=g([]);constructor(){this.coursesService.getCoursesDto().pipe(I(n=>{let t=n.map(r=>[r.Id,r.Title]);return this.forumService.getThreads(new Map(t))}),D(this.destroyRef)).subscribe({next:n=>{this.threads.set(n),this.error.set(null),this.loading.set(!1)},error:()=>{this.error.set("Nao foi possivel carregar os topicos do forum."),this.loading.set(!1)}})}trackByThread(n,t){return t.id}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=M({type:e,selectors:[["app-forum"]],decls:16,vars:2,consts:[["loadingState",""],["errorState",""],["emptyState",""],[1,"forum"],[1,"description"],["type","button"],[4,"ngIf","ngIfElse"],["class","forum__list",4,"ngIf","ngIfElse"],[1,"forum__list"],["class","thread",3,"thread--locked",4,"ngFor","ngForOf","ngForTrackBy"],[1,"thread"],[1,"thread__meta"],[1,"tags"],["class","tag",4,"ngIf"],[1,"tag","tag--course"],["class","tag tag--locked",4,"ngIf"],[1,"author"],[1,"tag"],[1,"tag","tag--locked"],[1,"state","state--info"],[1,"state","state--error"]],template:function(t,r){if(t&1&&(i(0,"section",3)(1,"header")(2,"div")(3,"h2"),a(4,"Forum colaborativo"),o(),i(5,"p",4),a(6,"Centralize as discussoes das trilhas e mantenha os alunos engajados."),o()(),i(7,"button",5),a(8,"Novo topico"),o()(),c(9,Q,2,2,"ng-container",6),o(),c(10,V,2,0,"ng-template",null,0,u)(12,W,2,1,"ng-template",null,1,u)(14,X,2,0,"ng-template",null,2,u)),t&2){let U=f(11);s(9),m("ngIf",!r.loading())("ngIfElse",U)}},dependencies:[E,O,S],styles:[".forum[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.forum[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}.forum[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.6rem;color:var(--surface-900)}.forum[_ngcontent-%COMP%]   header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.65rem 1.4rem;border-radius:11px;border:none;background:#0f172a14;color:var(--surface-700);font-weight:600;cursor:pointer}.forum__list[_ngcontent-%COMP%]{display:grid;gap:1rem}.thread[_ngcontent-%COMP%]{background:#fffffff2;border-radius:18px;padding:1.5rem;border:1px solid rgba(148,163,184,.14);box-shadow:0 18px 40px -38px #0f172a80;display:grid;gap:1rem}.thread--locked[_ngcontent-%COMP%]{opacity:.75;border-style:dashed}.thread__meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}.tags[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap}.tag[_ngcontent-%COMP%]{padding:.25rem .6rem;border-radius:999px;background:#6366f11f;color:var(--accent-600);font-size:.75rem;text-transform:uppercase;letter-spacing:.1em}.tag--course[_ngcontent-%COMP%]{background:#0f172a14;color:var(--surface-600)}.tag--locked[_ngcontent-%COMP%]{background:#f871711f;color:#b91c1c}.author[_ngcontent-%COMP%]{color:var(--surface-500);font-size:.9rem}.thread[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--surface-900);font-size:1.2rem;line-height:1.4}.thread[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:space-between;flex-wrap:wrap;color:var(--surface-500);font-size:.9rem}.thread[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto;padding:.55rem 1.2rem;border-radius:10px;border:none;background:#6366f129;color:var(--accent-600);font-weight:600;cursor:pointer}@media (max-width: 640px){.thread[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.thread[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}}.forum[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:.25rem 0 0;color:var(--surface-500);font-size:.95rem}.state[_ngcontent-%COMP%]{padding:1.5rem;border-radius:16px;text-align:center;font-weight:500;background:#94a3b826;color:var(--surface-600)}.state--error[_ngcontent-%COMP%]{background:#f871712e;color:#b91c1c}"],changeDetection:0})};export{B as ForumComponent};
